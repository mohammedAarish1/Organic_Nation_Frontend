<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Resource hints -->
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="preconnect" href="https://connect.facebook.net" crossorigin>

  <!-- Preload critical image -->
  <link rel="preload" as="image" href="https://organicnationmages.s3.amazonaws.com/homepage-banners/pickle/lg/pickle.webp"
    type="image/webp">

  <!-- <link href="https://fonts.googleapis.com/css2?family=Jersey+10&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> -->

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet">

  <!-- Google Tag Manager with async loading -->
  <script>
    // Defer GTM loading
    window.addEventListener('load', function () {
      const script = document.createElement('script');
      script.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-W9CXKK55';
      script.async = true;
      document.head.appendChild(script);

      // Initialize GTM after script loads
      script.onload = function () {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
          'gtm.start': new Date().getTime(),
          event: 'gtm.js'
        });
      };
    });
  </script>

  <!-- Google Analytics with minimal blocking -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }

    // Defer GA loading
    window.addEventListener('load', function () {
      const script = document.createElement('script');
      script.src = 'https://www.googletagmanager.com/gtag/js?id=G-KBKFW084WY';
      script.async = true;
      document.head.appendChild(script);

      script.onload = function () {
        gtag('js', new Date());
        gtag('config', 'G-KBKFW084WY', {
          'send_page_view': false // Defer page view until after critical content loads
        });
      };
    });
  </script>

  <!-- Meta Pixel Code with performance optimizations -->
  <script>
    // Defer Facebook Pixel loading
    window.addEventListener('load', function () {
      // Create a lightweight fbq stub
      window.fbq = function () {
        window.fbq.callMethod ?
          window.fbq.callMethod.apply(window.fbq, arguments) :
          window.fbq.queue.push(arguments)
      };
      window._fbq = window.fbq;
      window.fbq.push = window.fbq;
      window.fbq.loaded = true;
      window.fbq.version = '2.0';
      window.fbq.queue = [];

      // Load Facebook pixel script
      const script = document.createElement('script');
      script.src = 'https://connect.facebook.net/en_US/fbevents.js';
      script.async = true;
      document.head.appendChild(script);

      script.onload = function () {
        fbq('init', '397875066598539');
        fbq('track', 'PageView');
      };
    });
  </script>

  <!-- Google tag (gtag.js) event - delayed navigation helper -->
  <script>
    // Helper function to delay opening a URL until a gtag event is sent.
    // Call it in response to an action that should navigate to a URL.
    function gtagSendEvent(url) {
      var callback = function () {
        if (typeof url === 'string') {
          window.location = url;
        }
      };
      gtag('event', 'conversion_event_purchase_1', {
        'event_callback': callback,
        'event_timeout': 2000,
        // <event_parameters>
      });
      return false;
    }
  </script>

  <meta name="google-site-verification" content="lfAgd8_lz2afHqhTRhb03ADVs7lMjD44S9pHUGkeKF4" />
</head>

<body>
  <!-- Minimal GTM noscript -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W9CXKK55" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>

  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>

  <!-- Meta Pixel Noscript -->
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=397875066598539&ev=PageView&noscript=1" /></noscript>
</body>

</html>